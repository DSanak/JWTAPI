<!DOCTYPE html>
<html lang="pl">
<head id="head1" runat="server">
    <meta charset="utf-8" />
	<link rel="stylesheet" href="stylelogowanie.css" "type=text/css" />

    <script type="text/javascript">

        var savetoken;
        async function logIn() {
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");

            var raw = JSON.stringify({
                //"email": document.getElementById("login").value,
                //"password": document.getElementById("password").value   
                "email": "test@abc.pl",
                "password":"test1234"
            });

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: raw,
                redirect: 'follow'
            };

            fetch("https://localhost:7259/api/token", requestOptions)
                .then(response => {
                    if (response.ok) {
                        window.location.replace("https://localhost:7259/api/user/admin.html")
                        return response.text()
                    }
                })
                .then(data => {
                    savetoken = data;
                })
                .catch(error => console.log('error', error));


            //ogarnąc jak pobrać response.status i zrobić if z redirect na inną stronę

            /*
               const res = await fetch("https://localhost:7259/api/token", requestOptions)
                   .catch(error => console.log('error',error));

               const tokenREL = await res.json();

               console.log(res.status, tokenREL);


.then(function (response) {
                     console.log(response.status); // Will show you the status
                     if (!response.ok) {
                         throw new Error("HTTP status " + response.status);
                     }
                     return response.json();
               */
        }

        function redirect() {
            window.location.replace("https://localhost:7259/api/user/homepage")
        }
</script>


</head>
<body>

<div id ="srodek">
    <h1>Logowanie do aplikacji</h1>

	<b>Login</b> <input type="text" id="login" />
	<br>
	<br>
    <b>Hasło</b> <input type="password" id="password" />
	<br>
	<br>
	<b>Jednorazowe hasło</b> <input type="text" id="password" value ="a*sin(x)"/>
	<br>
	<br>
    <input type="submit" value="Zaloguj" onclick="logIn()" />
    <input type="submit" value="redirect" onclick="redirect()" />
	<div style="margin:auto;color:black;">
	<br>
	x=65
	<br>
	a=6
	</div>
    <div id="wynik"></div>
</div>

</body>
</html>