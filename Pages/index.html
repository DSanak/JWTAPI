<!DOCTYPE html>
<html lang="pl">
<head id="head1" runat="server">
    <meta charset="utf-8" />

    <script type="text/javascript">

        var savetoken;
        async function token() {
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");

            var raw = JSON.stringify({
                //"email": document.getElementById("login").value,
                //"password": document.getElementById("password").value   
                "email": "test@abc.com",
                "password":"$test@2022"
            });

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: raw,
                redirect: 'follow'
            };

            fetch("https://localhost:7259/api/token", requestOptions)
                .then(response => {
                    if (response.ok) {
                        window.location.replace("https://localhost:7259/api/user/homepage")
                        return response.text()
                    }
                })
                .then(data => {
                    savetoken = data;
                })
                .catch(error => console.log('error', error));


            //ogarnąc jak pobrać response.status i zrobić if z redirect na inną stronę

            /*
               const res = await fetch("https://localhost:7259/api/token", requestOptions)
                   .catch(error => console.log('error',error));

               const tokenREL = await res.json();

               console.log(res.status, tokenREL);


.then(function (response) {
                     console.log(response.status); // Will show you the status
                     if (!response.ok) {
                         throw new Error("HTTP status " + response.status);
                     }
                     return response.json();
               */
        }

        function redirect() {
            window.location.replace("https://localhost:7259/api/user/homepage")
        }



    </script>

</head>
<body>

    <h1>Hello, pls zaloguj się</h1>

    <input type="text" id="login" />
    <input type="password" id="password" />
    <input type="submit" value="Zaloguj" onclick="logIn()" />
    <input type="submit" value="Token" onclick="token()" />
    <input type="submit" value="Show Token" onclick="showToken()" />
    <input type="submit" value="redirect" onclick="redirect()" />

    <div id="wynik"></div>

</body>
</html>